# 1. gofmt的用法

`gofmt [flags] [path ...]`



```txt
The flags are:
  	-cpuprofile string
        将CPU配置文件写入此文件
    -d
        不将重新格式化的源打印到标准输出。
		如果一个文件的格式与gofmt的不同，则将差异部分打印到标准输出。
    -e
        打印所有（包括虚假）错误。
    -l
        不将格式化的源打印到标准输出。
		如果文件的格式与 gofmt 不同，则将其名称打印到标准输出。
    -r rule（string）
        在重新格式化之前，对源应用重写规则(例如，'a[b:len(a)] -> a[b:]')
    -s
        尝试简化代码（在应用重写规则后，如果有的话）。
    -w
       	不将重新格式化的源打印到标准输出。
       	如果文件的格式与 gofmt 不同，则用 gofmt 的版本覆盖它。
		如果在覆盖期间发生错误，原始文件将从自动备份中恢复
```

## 1.1 -s

gofmt默认不对代码进行简化，使用-s参数可以开启简化代码功能：


· 去除数组、切片、Map初始化时不必要的类型声明：


```go
[]T{T{}, T{}}
// 简化
[]T{{}, {}}
```

· 去除数组切片操作时不必要的索引：
```go
    s[a:len(s)]
// 将被简化为：
    s[a:]
```

· 去除迭代时非必要的变量赋值：
```go
// 如下形式的迭代：
for x, _ = range v {...}
// 将被简化为：
for x = range v {...}
// 如下形式的迭代：
for _ = range v {...}
// 将被简化为：
for range v {...}
```

## 1.2 -r

使用-r参数，按照`pattern -> replacement`的格式传入规则。

```go
// 检查文件中是否有不必要的括号:
gofmt -r '(a) -> a' -l *.go

// 删除括号:
gofmt -r '(a) -> a' -w *.go

```

